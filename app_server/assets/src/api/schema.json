{"openapi":"3.1.0","info":{"title":"Outline VPN","version":"1.0"},"paths":{"/api/health":{"get":{"tags":["Server"],"summary":"Health","description":"Проверка работоспособности сервиса.","operationId":"health","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RequestStatusResponse"}}}}}}},"/api/order/check":{"get":{"tags":["Orders"],"summary":"Check Order","description":"Проверка наличия заказа в системе.","operationId":"check_order","parameters":[{"name":"task_guid","in":"query","required":true,"schema":{"type":"string","description":"Идентификатор заказа","title":"Task Guid"},"description":"Идентификатор заказа"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CheckOrderResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/order/{task_guid}/":{"get":{"tags":["Orders"],"summary":"Get Order","operationId":"get_order","parameters":[{"name":"task_guid","in":"path","required":true,"schema":{"type":"string","title":"Task Guid"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/payment/init":{"get":{"tags":["Payments"],"summary":"Init Payment","description":"Инициализировать платеж.","operationId":"init_payment","parameters":[{"name":"task_guid","in":"query","required":true,"schema":{"type":"string","description":"Идентификатор заказа","title":"Task Guid"},"description":"Идентификатор заказа"},{"name":"is_recurrent","in":"query","required":false,"schema":{"type":"boolean","description":"Признак рекуррентности платежа","default":false,"title":"Is Recurrent"},"description":"Признак рекуррентности платежа"},{"name":"use_qr","in":"query","required":false,"schema":{"type":"boolean","description":"Оплата по QR-коду СБП","default":false,"title":"Use Qr"},"description":"Оплата по QR-коду СБП"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InitPaymentResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/payment/status":{"post":{"tags":["Payments"],"summary":"Payment Status Update","description":"Обновить статус платежа через систему HTTP-уведомлений банка.","operationId":"payment_status_update","requestBody":{"content":{"application/json":{"schema":{"anyOf":[{"$ref":"#/components/schemas/NotificationQrRequest"},{"$ref":"#/components/schemas/NotificationPaymentRequest"}],"title":"Payload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/payment/{payment_id}/status":{"get":{"tags":["Payments"],"summary":"Get Payment Status","description":"Получить статус платежа по его идентификатору в системе банка.","operationId":"get_payment_status","parameters":[{"name":"payment_id","in":"path","required":true,"schema":{"type":"integer","title":"Payment Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaymentStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/payment/charge":{"post":{"tags":["Payments"],"summary":"Payment Charge","description":"Провести автоматический периодический платеж.","operationId":"payment_charge","parameters":[{"name":"authorization","in":"header","required":false,"schema":{"type":"string","title":"Authorization"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaymentChargeRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RequestStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/subscription/reject":{"patch":{"tags":["Subscription"],"summary":"Subscription Reject","description":"Отменить активную подписку","operationId":"subscription_reject","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubscriptionRejectRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RequestStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"CheckOrderResponse":{"properties":{"is_valid":{"type":"boolean","title":"Is Valid"}},"type":"object","required":["is_valid"],"title":"CheckOrderResponse"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"InitPaymentResponse":{"properties":{"payment_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Уникальный идентификатор транзакции в системе Т‑Кассы"},"url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Ссылка на платежную форму"},"qr":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"QR-код на оплату"}},"type":"object","title":"InitPaymentResponse"},"NotificationPaymentRequest":{"properties":{"TerminalKey":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Идентификатор терминала"},"Amount":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Сумма в копейках"},"OrderId":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Идентификатор заказа в системе мерчанта"},"Success":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Успешность прохождения запроса"},"Status":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Статус платежа"},"PaymentId":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Уникальный идентификатор транзакции в системе Т‑Кассы"},"ErrorCode":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Код ошибки. 0 в случае успеха"},"Message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Краткое описание ошибки"},"Details":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Подробное описание ошибки"},"RebillId":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Идентификатор автоплатежа"},"CardId":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Идентификатор карты в системе Т‑Кассы"},"Pan":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Замаскированный номер карты или телефона"},"ExpDate":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Срок действия карты в формате MMYY, где YY — две последние цифры года"},"Token":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Подпись запроса. Формируется по такому же принципу, как и в случае запросов в Т‑Кассу."},"Data":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Дополнительные параметры платежа, переданные при создании заказа. "}},"type":"object","title":"NotificationPaymentRequest"},"NotificationQrRequest":{"properties":{"TerminalKey":{"type":"string","title":"Идентификатор терминала."},"RequestKey":{"type":"string","title":"Идентификатор запроса на привязку счета."},"AccountToken":{"type":"string","title":"Идентификатор привязки счета, назначаемый банком-эмитентом."},"BankMemberId":{"type":"string","title":"Идентификатор банка-эмитента клиента, который будет совершать оплату по привязанному счету — заполнен, если статус ACTIVE."},"BankMemberName":{"type":"string","title":"Наименование банка-эмитента. Заполнен, если передан BankMemberId."},"NotificationType":{"type":"string","title":"Тип уведомления, всегда — LINKACCOUNT."},"Success":{"type":"boolean","title":"Успешность прохождения запроса"},"ErrorCode":{"type":"string","title":"Код ошибки. 0 в случае успеха"},"Message":{"type":"string","title":"Краткое описание ошибки"},"Token":{"type":"string","title":"Подпись запроса. Формируется по такому же принципу, как и в случае запросов в Т‑Кассу."},"Status":{"type":"string","title":"Статус платежа"}},"type":"object","required":["NotificationType"],"title":"NotificationQrRequest"},"PaymentChargeRequest":{"properties":{"task_guid":{"type":"string","title":"Идентификатор задания на оплату"}},"type":"object","required":["task_guid"],"title":"PaymentChargeRequest"},"PaymentStatusResponse":{"properties":{"OrderId":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Идентификатор заказа в системе мерчанта"},"Status":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Статус транзакции"},"PaymentId":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Идентификатор платежа в системе Т‑Кассы"}},"type":"object","title":"PaymentStatusResponse"},"RequestStatusResponse":{"properties":{"success":{"type":"boolean","title":"Успешность запроса"},"message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Сообщение о результате запроса"}},"type":"object","required":["success"],"title":"RequestStatusResponse"},"SubscriptionRejectRequest":{"properties":{"task_guid":{"type":"string","title":"Task Guid"}},"type":"object","required":["task_guid"],"title":"SubscriptionRejectRequest"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}